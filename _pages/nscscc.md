---
title: 2024 "龙芯杯"
layout: single
permalink: /nscscc
last_modified_at: 2024.8.21
---

## 前言

似乎从大二上过数字逻辑，写过CPU大作业后，我就踏入了这条不归路。

暑假，我们借了机电楼824，从单周期CPU开始，到完成所有中断例外，也不过两周时间。
当时离提交还有三周左右，就剩下一个AXI I/F没有完成了，看起来一切进展顺利。
我认为我自己的水平足够，也许是之前的内存保证了一定可以在下一周期返回的缘故，
选择了跳过书中建议的先实现类SRAM I/F，直接将没有握手信号的SRAM I/F接到了一个AXI转接桥上。
但这个行为也成为了我痛苦的根源。事实证明：

> **在没有绝对的经验与把握的前提下，不要试图忽视任何成熟的建议与警告。
> 也不要好高骛远，眼高手低，过于追求完美。**

得益于未经过思考写下的交互与流水线控制逻辑，整个CPU在加上AXI I/F后堪称摇摇欲坠。
任何修改都可能让CPU跑飞，更不用说添加更复杂的逻辑。
此外，初学者用一个月的时间显然无法完成一个AXI I/F的CPU，更不用说LoongArch32R几乎没有什么资料可以参考。

之后，我们似乎过于追求一个部件的完美，而忽略了整体。
23年的CPU我们采用了一款性能非常优秀的除法器：主频高、运算快。那是一个支持110MHz主频，平均3周期以内可以算完的整数触发器。
我们认为这个除法器一定会给我们带来巨大的收益，但当我们发现每一次访存，无论是取指令还是取数据，都会被加上25周期的延时后，
除法运算省下来的时间可以说是九牛一毛。这对于我们初赛的性能测试几乎没有任何帮助，除了可以在报告中写上一笔。

过了这个假期，我决定痛定思痛，从主要矛盾入手，提升性能。
于是，一个dcache，我写了几周。当想要做一些自己的事时，总是被各种杂事缠身，当然，也可能是我对这个事情很害怕，试图用各种事情
掩盖过去，直到一个不能再拖的时候，才会开始动手。

...

2024年8月

重庆
