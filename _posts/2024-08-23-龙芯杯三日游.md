---
title: "龙芯杯三日游"
layout: posts
# permalink: 
last_modified_at: 2024.8.23
categories:
  - diary
tags:
  - cpu
  - diary
---

连续一个月，或者说断断续续小半年的努力最终都在这一刻钟内展示出来。

Defence 在 14 世纪末有了“答辩”之意，我认为这和它更早就有的 protection 含义是类似的。不过一个是在理论上，保护自己的观点、意见，驳斥对方的；一个在物理上保护一个事物免受侵害。

线下的指令答题可以说人人都会，没有人会做不出来，也没有人会因为这个而失分。我认为这只是一个确认环节——确认参赛者对自己的代码足够熟悉，或者说，是自己写的。因此，“龙芯杯”的决赛主要内容事实上只有一项：答辩。答辩提供了一个评委与选手直接交流的机会，选手也可以展示自己的设计，展示自己几个月的心血。

我认为设计 CPU 有几道坎：流水、cache、超标量、乱序和多核。初次设计流水线时，我只会照着各类参考书东拼西凑，设计 cache 也是对着书上的设计，之后不停 debug，我起初以为这些都是非常复杂的工作，直到真正写出一个能用的 demo 我才发现，原来这些并不复杂，复杂的是整个设计的过程，而非编码：一个看起来微不足道的点可能就会让整个处理器无法工作，临时加的各种信号、寄存器都成为了后期整理与优化的绊脚石。当我设计这个顺序双发处理器时，由于未经思索便写下了电路，有非常多的地方存在问题，每次回看代码，每次优化都会发现一些错误。这些错误可能依靠简单的测试程序根本无法发现，但总会在一些关键的时候成为压垮你的稻草。现在，我已经完成了顺序双发处理器的设计，下一步，可能将会是乱序，或者压榨顺序多发的极限，不过这都是以后的事情了。

希望我能继续完善这个处理器，完善文档，让他能够被后人所利用，让他们少走弯路。并且将它留在学校，作为教学资源传承下去，直到更好、更高水平的代码出现。
